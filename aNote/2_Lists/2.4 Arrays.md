### Array Basics

数组是内存中一块连续的空间，所有块中类型一致，并固定长度，通过编号访问

链表则是节点散落在各处，内部字段类型可不同，可通过增删改变长度，续逐个跳来访问某一结点。

Arrays consist of:

- A fixed integer length, N
- A sequence of N memory boxes (N = length) where all boxes are of the same type, and are numbered 0 through N - 1.

连续性：CPU一次缓存行科预取多个元素，但长度很难动态调整

#### Array Creation 

- `x = new int[3];` 默认值为0
- `y = new int[]{1, 2, 3, 4, 5};`
- `int[] z = {9, 10, 11, 12, 13};`

#### Array Access and Modification

```java
int[] z = null;        // z 只是个“空”引用
int[] x, y;            // 声明两个数组引用

x = new int[]{1,2,3,4,5};
y = x;                 // y 和 x 指向同一块数组（浅拷贝）
x = new int[]{-1,2,5,4,99}; // x 改指向新数组；y 仍指向旧数组

y = new int[3];        // 新建长度 3 的数组，元素默认为 0
z = new int[0];        // 长度 0 也合法
int xL = x.length;     // 数组字段 length

String[] s = new String[6];
s[4] = "ketchup";
s[x[3] - x[1]] = "muffins"; // 4-2 = 2 ⇒ s[2] = "muffins"

int[] b = {9,10,11};
System.arraycopy(b, 0, x, 3, 2);    
```

养成先检查 `index >= 0 && index < A.length` 的习惯，或用增强 `for` 循环。

##### System.arraycopy

```java
System.arraycopy(src,  srcPos,
                 dest, destPos,
                 length);
```

- **src / dest**：源、目标数组

- **srcPos / destPos**：开始复制的下标

- **length**：要复制的元素个数

与 `for` 循环相比，`arraycopy` 由 JVM 本地实现，**更快、更少代码**；适合大批量复制

### 2D Arrays in Java

所谓的二维数组实际上只是一个数组的数组，每一行本身就是一个 `int[]` 对象

**Exercise 2.4.1:** After running the code below, what will be the values of x[0][0] and w[0][0]? Check your work by clicking [here](http://goo.gl/fCZ9Dr).

```java
int[][] x = {{1, 2, 3}, {4, 5, 6}, {7, 8, 9}};

int[][] z = new int[3][];
z[0] = x[0];
z[1] = x[1];
z[2] = x[2];
z[0][0] = -z[0][0];

int[][] w = new int[3][3];
System.arraycopy(x[0], 0, w[0], 0, 3);
System.arraycopy(x[1], 0, w[1], 0, 3);
System.arraycopy(x[2], 0, w[2], 0, 3);
w[0][0] = -w[0][0];
```

##### 浅拷贝 vs. 深拷贝

- **浅拷贝**：`z[0] = x[0];` —— 两行共用同一内存，改一处两处变。

- **深拷贝**：`System.arraycopy(x[0],0,w[0],0,3);` —— 复制值，彼此独立。

输出为：

```java
x[0][0] == -1   // 被 z[0][0] 取负波及
w[0][0] == -1   // 自己被赋负值
```

### Arrays vs. Classes 

数组和类都可以存储单元，并且二至都是数量固定的。即数组的长度无法更改；类的字段无法添加删除。

数组的盒子按数字编号，盒子里的东西必须同一种类型。

类的盒子按名字标识，盒子里的东西可以各不相同。

By contrast, specifying fields in a class is not something we do at runtime. For example, consider the code below:

```java
String fieldOfInterest = "mass";
Planet p = new Planet(6e24, "earth");
double mass = p[fieldOfInterest];
```

If we tried compiling this, we'd get a syntax error.

```
$ javac classDemo
FieldDemo.java:5: error: array required, but Planet found
        double mass = earth[fieldOfInterest];        
                               ^
```

The same problem occurs if we try to use dot notation:

```java
String fieldOfInterest = "mass";
Planet p = new Planet(6e24, "earth");
double mass = p.fieldOfInterest;
```

Compiling, we'd get:

```
$ javac classDemo
FieldDemo.java:5: error: cannot find symbol
        double mass = earth.fieldOfInterest;        
                           ^
  symbol:   variable fieldOfInterest
  location: variable earth of type Planet
```